# การทำงานของ Simple Agent ใน Langflow

## Simple Agent คืออะไร?

Simple Agent ใน Langflow เป็นตัวอย่างพื้นฐานของระบบ Agent ที่สามารถใช้ Tool ต่างๆ เพื่อแก้ปัญหาที่ซับซ้อนได้ Simple Agent มีความสามารถในการ:
- วิเคราะห์คำถามและกำหนดวิธีการแก้ปัญหา
- เลือกใช้ Tool ที่เหมาะสมกับงาน
- ทำงานตามลำดับขั้นตอนเพื่อบรรลุเป้าหมาย
- อธิบายกระบวนการคิดและการตัดสินใจ

## องค์ประกอบของ Simple Agent

### 1. LLM (Large Language Model)
LLM เป็นหัวใจของ Agent ทำหน้าที่:
- วิเคราะห์คำถามของผู้ใช้
- ตัดสินใจเลือก Tool ที่เหมาะสม
- วางแผนการแก้ปัญหาเป็นขั้นตอน
- สร้างคำตอบสุดท้ายให้ผู้ใช้

### 2. Tools
Tools เป็นความสามารถที่ Agent สามารถเรียกใช้ได้ ตัวอย่างเช่น:
- Search Tool: ค้นหาข้อมูลจาก Vector Store
- Calculator: คำนวณทางคณิตศาสตร์
- Human Input Tool: ขอข้อมูลเพิ่มเติมจากผู้ใช้

### 3. Prompt Template
Prompt Template ช่วยกำหนดรูปแบบการสื่อสารและพฤติกรรมของ Agent ประกอบด้วย:
- System Message: บอกบทบาทและความสามารถของ Agent
- การอธิบาย Tools: แนะนำวิธีการใช้ Tools แต่ละชนิด
- รูปแบบการตอบกลับ: กำหนดโครงสร้างการตอบของ Agent

### 4. Memory
Memory ช่วยให้ Agent จดจำบทสนทนาก่อนหน้า ทำให้สามารถ:
- เข้าใจบริบทของการสนทนา
- อ้างอิงข้อมูลที่ผู้ใช้ให้ไว้ก่อนหน้านี้
- สร้างการสนทนาที่ต่อเนื่อง

## กระบวนการทำงานของ Simple Agent

### 1. การรับคำถามจากผู้ใช้
- ผู้ใช้ป้อนคำถามผ่านส่วนต่อประสาน (Interface)
- คำถามจะถูกส่งไปยัง Agent พร้อมกับประวัติการสนทนา (ถ้ามี)

### 2. การวิเคราะห์และการวางแผน
- Agent วิเคราะห์คำถามและกำหนดวิธีการแก้ปัญหา
- Agent แสดงกระบวนการคิด (Thought) เพื่ออธิบายแผนการทำงาน

### 3. การเลือกและการใช้ Tool
- Agent เลือก Tool ที่เหมาะสมกับงาน
- Agent เรียกใช้ Tool พร้อมกับส่งพารามิเตอร์ที่จำเป็น
- Tool ประมวลผลและส่งผลลัพธ์กลับมาให้ Agent

### 4. การคิดและตัดสินใจเพิ่มเติม
- Agent ประมวลผลผลลัพธ์จาก Tool
- หากจำเป็น Agent อาจใช้ Tool อื่นๆ เพิ่มเติม
- Agent อาจทำซ้ำขั้นตอนนี้หลายครั้งจนกว่าจะได้ข้อมูลเพียงพอ

### 5. การสร้างคำตอบสุดท้าย
- เมื่อมีข้อมูลเพียงพอ Agent จะสร้างคำตอบสุดท้าย
- คำตอบจะถูกส่งกลับไปยังผู้ใช้พร้อมกับอธิบายที่มาของคำตอบ

## การปรับใช้ Simple Agent กับระบบ RAG

เมื่อนำ Simple Agent มาใช้กับระบบ RAG (Retrieval Augmented Generation) สำหรับข้อมูลอาหารไทย จะมีการทำงานดังนี้:

### 1. การตั้งค่า Search Tool ให้ใช้ RAG
- กำหนดให้ Search Tool เชื่อมต่อกับ Vector Store ที่มีข้อมูลอาหารไทย
- Agent จะสามารถค้นหาข้อมูลเกี่ยวกับอาหารไทยผ่าน Search Tool

### 2. ตัวอย่างการทำงาน
เมื่อผู้ใช้ถามว่า "วัตถุดิบหลักในการทำต้มยำกุ้งมีอะไรบ้าง?" ระบบจะทำงานดังนี้:

1. **Thought**: ฉันต้องค้นหาข้อมูลเกี่ยวกับวัตถุดิบในการทำต้มยำกุ้ง
2. **Action**: เลือกใช้ Search Tool
3. **Action Input**: "วัตถุดิบ ต้มยำกุ้ง"
4. **Observation**: (ผลการค้นหาจาก Vector Store เกี่ยวกับต้มยำกุ้ง)
5. **Thought**: ฉันได้ข้อมูลเกี่ยวกับวัตถุดิบต้มยำกุ้งแล้ว สามารถตอบคำถามได้
6. **Answer**: วัตถุดิบหลักในการทำต้มยำกุ้งประกอบด้วย: กุ้งสด (กุ้งแม่น้ำหรือกุ้งทะเล), น้ำซุป, ข่า, ตะไคร้, ใบมะกรูด, พริกขี้หนูสด, น้ำปลา, น้ำมะนาว, เห็ดฟางหรือเห็ดนางฟ้า, หอมแดง, ผักชี และสำหรับต้มยำน้ำข้นจะมีน้ำพริกเผาและกะทิหรือนมข้นเพิ่มเติม

## ข้อแนะนำในการปรับแต่ง Simple Agent

### 1. การปรับแต่ง Prompt
- กำหนดบทบาทของ Agent ให้ชัดเจน เช่น "คุณเป็นผู้เชี่ยวชาญด้านอาหารไทย"
- อธิบาย Tools ให้ละเอียดเพื่อให้ Agent เลือกใช้ได้อย่างเหมาะสม
- กำหนดรูปแบบการตอบที่เป็นมิตรและเข้าใจง่าย

### 2. การเพิ่ม Tools เฉพาะทาง
- **Recipe Tool**: ค้นหาสูตรอาหารไทยโดยเฉพาะ
- **Ingredient Substitution Tool**: แนะนำวัตถุดิบทดแทนที่หาได้ง่ายกว่า
- **Measurement Conversion Tool**: แปลงหน่วยการวัดในสูตรอาหาร

### 3. การปรับปรุงประสิทธิภาพ
- ปรับพารามิเตอร์ของ Vector Store เพื่อให้การค้นหาแม่นยำขึ้น
- เพิ่ม Temperature ของ LLM ให้ต่ำลงเพื่อให้คำตอบแม่นยำและตรงประเด็น
- กำหนด max_iterations ให้เหมาะสมเพื่อป้องกันการวนลูปมากเกินไป